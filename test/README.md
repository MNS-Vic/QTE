# 量化回测引擎比较与评估

本项目旨在对比和评估不同量化回测框架的性能和特点，帮助交易者和开发者选择最适合自己需求的回测工具。这些测试脚本也作为本 `Quantitative-Backtesting-Engine` 项目未来功能实现和性能对标的基准参考。

## 详细框架设计与开发蓝图

关于 `Quantitative-Backtesting-Engine` 项目的详细框架描述、架构设计、核心组件、开发计划以及从其他开源框架中借鉴的设计原则和经验，请参阅项目根目录下的以下文档：

*   **框架描述文档:** [`../../docs/architecture/FRAMEWORK_DESCRIPTION.md`](../../docs/architecture/FRAMEWORK_DESCRIPTION.md)
*   **开发计划文档:** [`../../docs/architecture/DEVELOPMENT_PLAN.md`](../../docs/architecture/DEVELOPMENT_PLAN.md)
*   **设计原则与经验借鉴(记忆银行):** [`../../docs/architecture/DESIGN_PRINCIPLES_AND_LEARNINGS.md`](../../docs/architecture/DESIGN_PRINCIPLES_AND_LEARNINGS.md)

## 当前被测试的框架 (模拟实现)

本项目当前的测试脚本主要针对以下几个主流的回测框架进行了模拟实现和初步对比：

1.  **vectorbt** - 基于向量化操作的高性能回测框架
2.  **LEAN** - QuantConnect开发的专业级事件驱动回测引擎 (模拟其核心思想)
3.  **vnpy** - 国内流行的事件驱动量化交易平台 (模拟其核心思想)

## 测试方法

为了公平对比各框架的性能，我们在所有模拟的框架上实现了相同的测试用例：

*   **策略:** 双均线交叉策略（简单移动平均线）
*   **时间段:** 2020-01-01 到 2022-12-31
*   **初始资金:** 100,000
*   **交易标的:** 上证指数 (若无法获取，则使用随机模拟数据)

主要考察以下几个方面：

*   执行时间（回测速度）
*   内存占用 (大致评估)
*   模拟实现的功能完整性
*   代码结构的易理解性

## 框架特点对比 (基于模拟实现与公开资料)

| 特性         | vectorbt (原生)          | LEAN (模拟/原生特点)   | vnpy (模拟/原生特点)      |
| :----------- | :----------------------- | :--------------------- | :------------------------ |
| **核心架构** | 向量化                   | 事件驱动               | 事件驱动                  |
| **运行速度** | 极快 (尤其参数优化时)    | 中等                   | 中等                      |
| **内存占用** | 中等                     | 中等                   | 较低                      |
| **上手难度** | 中等 (需理解向量化)      | 较高 (功能全面复杂)    | 中等 (中文社区友好)       |
| **实盘支持** | 需额外开发               | 原生支持               | 原生支持多种国内接口    |
| **参数优化** | 原生内置，极快           | 支持 (相对较慢)        | 支持                      |
| **多资产**   | 支持                     | 全面支持多市场多资产   | 支持国内外多市场          |
| **可视化**   | 高级交互式图表           | 较完整的可视化报告     | 基础图表                  |
| **适用场景** | 海量参数优化、高频策略研究 | 专业量化、实盘交易     | 国内市场策略实盘交易      |

## 框架优缺点 (简述)

### vectorbt
*   **优点:** 速度快，参数优化强，可视化好。
*   **缺点:** 实盘需自行对接，学习曲线对新手略陡。

### LEAN (QuantConnect)
*   **优点:** 专业级，功能全面，跨市场，回测/实盘代码一致性高。
*   **缺点:** 复杂，学习成本高，资源消耗可能较大。

### vnpy
*   **优点:** 国内生态好，接口丰富，中文友好，模块化。
*   **缺点:** 核心回测速度一般，部分高级功能依赖商业版或需自行增强。

## 测试脚本使用方法

在本 `test/` 目录下，可以运行以下脚本来测试和对比不同框架的模拟实现：

```bash
# 运行所有框架的模拟测试并输出性能对比与建议
python run_all_tests.py

# 单独运行 vectorbt 的测试脚本
python test_vectorbt_backtest.py

# 单独运行 LEAN 风格的模拟测试脚本
python test_lean_backtest.py

# 单独运行 vnpy 风格的模拟测试脚本
python test_vnpy_backtest.py

# 仅运行性能比较和特点总结脚本
python test_backtest_frameworks.py
```

## 注意事项

1.  运行测试前请确保已安装必要的依赖包 (见项目根目录 `README.md` 及 `requirements.txt`)。
2.  `test_lean_backtest.py` 和 `test_vnpy_backtest.py` 是对LEAN和vn.py核心思想的**简化模拟实现**，并非直接使用这两个框架的完整代码。目的是通过模拟其架构特点来进行概念对比和性能评估的初步探索。
3.  真实的框架选择应基于更广泛的调研和针对具体需求的深入评估。

## 后续工作 (针对QTE项目)

1.  根据 `docs/architecture/DEVELOPMENT_PLAN.md` 逐步实现QTE的核心功能。
2.  未来考虑加入对更多真实开源回测框架 (如 Backtrader, Zipline-Reloaded) 的直接集成和对比测试。
3.  实现更复杂的测试策略，如多因子模型、日内高频策略等，以更全面地评估框架性能。
4.  引入更严格的性能基准测试和真实市场数据进行验证。 