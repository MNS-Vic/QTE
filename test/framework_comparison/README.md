# 量化回测框架对比测试

本目录包含了多个模拟主流量化回测框架特点的测试脚本，用于比较不同架构设计的优缺点，并为QTE (Quantitative Trading Engine) 框架的开发提供参考。

## 包含的测试脚本

1. **test_vectorbt_backtest_可复用.py**
   - 模拟 VectorBT 框架的向量化回测特点
   - 核心特点：高性能向量化操作、大规模参数优化、Pandas 数据处理

2. **test_vectorbt_ml_hft_可复用.py**
   - 基于VectorBT风格扩展的高频数据与机器学习回测框架
   - 核心特点：向量化高频数据处理、机器学习模型集成、多频率数据支持

3. **test_lean_backtest_可复用.py**
   - 模拟 QuantConnect LEAN 框架的事件驱动回测特点
   - 核心特点：模块化架构、事件驱动设计、高真实度回测

4. **test_vnpy_backtest_可复用.py**
   - 模拟 vnpy 框架的事件驱动回测特点
   - 核心特点：事件引擎设计、模块化架构、全市场支持

## 框架对比

| 特性 | VectorBT 风格 | VectorBT-ML-HFT | LEAN 风格 | vnpy 风格 |
|------|--------------|-----------------|-----------|-----------|
| 架构设计 | 向量化计算 | 向量化计算 | 事件驱动 | 事件驱动 |
| 性能表现 | 极高（批量处理） | 极高（特别适合高频） | 中等 | 中等 |
| 真实度 | 较低 | 中等 | 高 | 高 |
| 参数优化 | 非常强大 | 非常强大 | 有但不突出 | 有但不突出 |
| 特色功能 | 大规模回测 | 机器学习集成、高频数据 | 事件模拟、多资产 | 事件模拟、全市场 |
| 代码结构 | 函数式风格 | 函数式+ML模型 | 面向对象 | 面向对象 |
| 适用场景 | 大规模参数扫描、研究型探索 | 高频数据、机器学习策略 | 精细化策略回测、接近实盘环境 | 跨市场策略开发 |
| 复杂度控制 | 简单 | 中等 | 复杂 | 复杂 |
| 实盘接口对接 | 不直接支持 | 通过模型部署支持 | 强大的实盘接口 | 强大的实盘接口 |
| 适合研究类型 | 传统指标 | 高频、机器学习 | 低频/中频策略 | 低频/中频策略 |

## 使用方法

每个测试脚本都可以独立运行，展示相应框架风格的特点：

```bash
# 运行VectorBT风格回测
python test_vectorbt_backtest_可复用.py

# 运行VectorBT风格的高频数据机器学习回测
python test_vectorbt_ml_hft_可复用.py

# 运行LEAN风格回测
python test_lean_backtest_可复用.py

# 运行vnpy风格回测
python test_vnpy_backtest_可复用.py
```

## 测试策略

基础测试脚本实现了相同的双均线交叉策略：
- 使用10日和30日移动平均线
- 当快线上穿慢线时买入
- 当快线下穿慢线时卖出

高频数据机器学习脚本：
- 使用随机森林模型预测价格走势
- 生成丰富的技术指标和特征
- 支持多种频率数据（日、小时、分钟、tick）
- 可以保存和加载训练好的模型

## 高频数据机器学习回测框架亮点

1. **多频率数据支持**：
   - 日线、小时线、分钟线、Tick数据
   - 根据频率自动调整特征计算

2. **强大的特征工程**：
   - 自动生成40+技术指标特征
   - 针对高频数据的特殊特征（买卖盘压力、价差、日内效应等）

3. **机器学习集成**：
   - 随机森林、梯度提升等模型支持
   - 模型评估、特征重要性分析
   - 模型保存与加载

4. **高性能回测**：
   - 向量化计算保证高频数据处理速度
   - 内存优化，可处理大规模数据集

## QTE框架开发借鉴

QTE框架将借鉴这些框架的优点：
1. 从VectorBT借鉴高性能向量化计算和参数优化能力
2. 从VectorBT-ML-HFT借鉴高频数据处理和机器学习集成能力
3. 从LEAN借鉴模块化事件驱动架构和高真实度回测流程
4. 从vnpy借鉴事件引擎设计和全市场支持

QTE将采用双核心设计：
- 向量化核心：用于快速回测、高频数据处理和参数优化
- 事件驱动核心：用于高真实度模拟和实盘兼容

## 注意事项

- 这些测试脚本是对原始框架特点的模拟，不依赖原框架
- 简化了部分复杂功能，但保留了核心设计理念
- 所有脚本都使用相同的双均线策略（机器学习版本除外），便于公平比较
- 如果没有实际数据，脚本会自动生成模拟数据
- 机器学习模型需要安装scikit-learn和joblib依赖库 