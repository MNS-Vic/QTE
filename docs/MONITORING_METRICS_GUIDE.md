# QTEç›‘æ§æŒ‡æ ‡æŒ‡å—

## ğŸ“Š æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜QTEé‡åŒ–äº¤æ˜“å¼•æ“çš„æ‰€æœ‰ç›‘æ§æŒ‡æ ‡ï¼ŒåŒ…æ‹¬æŒ‡æ ‡å«ä¹‰ã€æ­£å¸¸èŒƒå›´ã€å¼‚å¸¸é˜ˆå€¼å’Œå“åº”æµç¨‹ã€‚

## ğŸ¯ ç›‘æ§æŒ‡æ ‡åˆ†ç±»

### 1. ä¸šåŠ¡æŒ‡æ ‡ (Business Metrics)

#### 1.1 äº¤æ˜“ç›¸å…³æŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `qte_trades_total` | æ€»äº¤æ˜“ç¬”æ•° | æ ¹æ®ç­–ç•¥è€Œå®š | 1å°æ—¶å†…<10ç¬” | æ£€æŸ¥ç­–ç•¥çŠ¶æ€ |
| `qte_trading_volume_total` | æ€»äº¤æ˜“é‡ | æ ¹æ®å¸‚åœºè€Œå®š | å¼‚å¸¸åä½/åé«˜ | æ£€æŸ¥å¸‚åœºæ•°æ® |
| `qte_orders_total` | æ€»è®¢å•æ•° | æ­£å¸¸äº¤æ˜“æ—¶æ®µ>0 | 30åˆ†é’Ÿå†…=0 | æ£€æŸ¥è®¢å•ç³»ç»Ÿ |
| `qte_orders_rejected_total` | è¢«æ‹’ç»è®¢å•æ•° | <5% | >10% | æ£€æŸ¥é£æ§è§„åˆ™ |

**å“åº”æµç¨‹**:
```
1. æ£€æŸ¥ç­–ç•¥è¿è¡ŒçŠ¶æ€
2. éªŒè¯å¸‚åœºæ•°æ®è¿æ¥
3. æ£€æŸ¥é£æ§å‚æ•°è®¾ç½®
4. è”ç³»äº¤æ˜“å›¢é˜Ÿç¡®è®¤
```

#### 1.2 æŠ•èµ„ç»„åˆæŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `qte_portfolio_total_value` | æŠ•èµ„ç»„åˆæ€»ä»·å€¼ | æ ¹æ®åˆå§‹èµ„é‡‘ | åç¦»>20% | ç«‹å³æ£€æŸ¥æŒä»“ |
| `qte_portfolio_pnl` | æŠ•èµ„ç»„åˆç›ˆäº | æ ¹æ®ç­–ç•¥é¢„æœŸ | æ—¥æŸå¤±>5% | é£é™©æ§åˆ¶æ£€æŸ¥ |
| `qte_portfolio_risk_exposure` | é£é™©æ•å£ | <é£é™©é™åˆ¶ | >é£é™©é™åˆ¶ | ç«‹å³å‡ä»“ |
| `qte_open_positions` | å¼€æ”¾æŒä»“æ•° | æ ¹æ®ç­–ç•¥ | å¼‚å¸¸å¢åŠ  | æ£€æŸ¥ç­–ç•¥é€»è¾‘ |

**å“åº”æµç¨‹**:
```
1. éªŒè¯æŒä»“æ•°æ®å‡†ç¡®æ€§
2. æ£€æŸ¥ä»·æ ¼æ•°æ®æ˜¯å¦å¼‚å¸¸
3. è¯„ä¼°é£é™©æ•å£åˆç†æ€§
4. å¿…è¦æ—¶æ‰§è¡Œé£æ§æªæ–½
```

#### 1.3 ç­–ç•¥æŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `qte_strategy_pnl` | ç­–ç•¥ç›ˆäº | æ ¹æ®å†å²è¡¨ç° | è¿ç»­äºæŸ>é˜ˆå€¼ | æš‚åœç­–ç•¥ |
| `qte_strategy_sharpe_ratio` | å¤æ™®æ¯”ç‡ | >0.5 | <0.3 | ç­–ç•¥ä¼˜åŒ– |
| `qte_strategy_win_rate` | èƒœç‡ | æ ¹æ®ç­–ç•¥ç±»å‹ | æ˜¾è‘—ä¸‹é™ | ç­–ç•¥æ£€æŸ¥ |

### 2. ç³»ç»ŸæŒ‡æ ‡ (System Metrics)

#### 2.1 åº”ç”¨æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `qte_event_processing_rate` | äº‹ä»¶å¤„ç†é€Ÿç‡ | >1000/ç§’ | <500/ç§’ | æ€§èƒ½ä¼˜åŒ– |
| `qte_event_queue_size` | äº‹ä»¶é˜Ÿåˆ—é•¿åº¦ | <1000 | >5000 | æ¸…ç†é˜Ÿåˆ— |
| `qte_request_duration_seconds` | è¯·æ±‚å“åº”æ—¶é—´ | <100ms | >1ç§’ | æ€§èƒ½è°ƒä¼˜ |
| `qte_memory_usage_bytes` | å†…å­˜ä½¿ç”¨é‡ | <80% | >90% | å†…å­˜ä¼˜åŒ– |

**å“åº”æµç¨‹**:
```
1. æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
2. åˆ†ææ€§èƒ½ç“¶é¢ˆ
3. ä¼˜åŒ–ä»£ç æˆ–å¢åŠ èµ„æº
4. ç›‘æ§æ”¹è¿›æ•ˆæœ
```

#### 2.2 åŸºç¡€è®¾æ–½æŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `node_cpu_seconds_total` | CPUä½¿ç”¨ç‡ | <70% | >85% | èµ„æºæ‰©å®¹ |
| `node_memory_MemAvailable_bytes` | å¯ç”¨å†…å­˜ | >20% | <10% | å†…å­˜æ¸…ç† |
| `node_filesystem_avail_bytes` | å¯ç”¨ç£ç›˜ç©ºé—´ | >20% | <10% | ç£ç›˜æ¸…ç† |
| `node_network_receive_bytes_total` | ç½‘ç»œæ¥æ”¶å­—èŠ‚ | æ­£å¸¸æ³¢åŠ¨ | å¼‚å¸¸å³°å€¼ | ç½‘ç»œæ£€æŸ¥ |

### 3. æ•°æ®è´¨é‡æŒ‡æ ‡ (Data Quality Metrics)

#### 3.1 å¸‚åœºæ•°æ®æŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `qte_last_market_data_timestamp` | æœ€åæ•°æ®æ—¶é—´æˆ³ | <5åˆ†é’Ÿå‰ | >5åˆ†é’Ÿå‰ | æ£€æŸ¥æ•°æ®æº |
| `qte_data_feed_connected` | æ•°æ®æºè¿æ¥çŠ¶æ€ | 1 (è¿æ¥) | 0 (æ–­å¼€) | é‡è¿æ•°æ®æº |
| `qte_price_anomalies_total` | ä»·æ ¼å¼‚å¸¸æ•°é‡ | <1% | >5% | æ•°æ®éªŒè¯ |
| `qte_market_data_latency_seconds` | æ•°æ®å»¶è¿Ÿ | <100ms | >1ç§’ | ç½‘ç»œä¼˜åŒ– |

**å“åº”æµç¨‹**:
```
1. æ£€æŸ¥æ•°æ®æºè¿æ¥çŠ¶æ€
2. éªŒè¯ç½‘ç»œè¿æ¥è´¨é‡
3. æ£€æŸ¥æ•°æ®å¤„ç†é€»è¾‘
4. è”ç³»æ•°æ®æä¾›å•†
```

### 4. å®‰å…¨æŒ‡æ ‡ (Security Metrics)

#### 4.1 è®¿é—®å®‰å…¨æŒ‡æ ‡

| æŒ‡æ ‡åç§° | æè¿° | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ | å“åº”æµç¨‹ |
|---------|------|----------|----------|----------|
| `qte_auth_failures_total` | è®¤è¯å¤±è´¥æ¬¡æ•° | <10/å°æ—¶ | >50/å°æ—¶ | å®‰å…¨æ£€æŸ¥ |
| `qte_suspicious_requests_total` | å¯ç–‘è¯·æ±‚æ•° | 0 | >0 | å®‰å…¨åˆ†æ |
| `nginx_http_requests_total` | HTTPè¯·æ±‚æ€»æ•° | æ­£å¸¸ä¸šåŠ¡é‡ | å¼‚å¸¸å³°å€¼ | DDoSæ£€æŸ¥ |

**å“åº”æµç¨‹**:
```
1. åˆ†æå®‰å…¨æ—¥å¿—
2. æ£€æŸ¥IPæ¥æº
3. å®æ–½å®‰å…¨æªæ–½
4. é€šçŸ¥å®‰å…¨å›¢é˜Ÿ
```

## ğŸš¨ å‘Šè­¦å“åº”æµç¨‹

### 1. P0çº§åˆ«å‘Šè­¦ (å…³é”®)

**è§¦å‘æ¡ä»¶**:
- ç³»ç»Ÿå®Œå…¨ä¸å¯ç”¨
- æ•°æ®ä¸¢å¤±é£é™©
- å®‰å…¨æ¼æ´

**å“åº”æµç¨‹**:
```
1. ç«‹å³å“åº” (5åˆ†é’Ÿå†…)
2. é€šçŸ¥æ‰€æœ‰ç›¸å…³äººå‘˜
3. å¯åŠ¨åº”æ€¥é¢„æ¡ˆ
4. å®æ–½ä¸´æ—¶è§£å†³æ–¹æ¡ˆ
5. æ ¹æœ¬åŸå› åˆ†æ
6. æ°¸ä¹…ä¿®å¤
7. äº‹åæ€»ç»“
```

**è”ç³»äºº**:
- æŠ€æœ¯è´Ÿè´£äºº: +86-xxx-xxxx-xxxx
- è¿ç»´è´Ÿè´£äºº: +86-xxx-xxxx-xxxx
- ä¸šåŠ¡è´Ÿè´£äºº: +86-xxx-xxxx-xxxx

### 2. P1çº§åˆ«å‘Šè­¦ (é«˜)

**è§¦å‘æ¡ä»¶**:
- æ ¸å¿ƒåŠŸèƒ½å—å½±å“
- æ€§èƒ½ä¸¥é‡ä¸‹é™
- æ•°æ®è´¨é‡é—®é¢˜

**å“åº”æµç¨‹**:
```
1. 15åˆ†é’Ÿå†…å“åº”
2. é€šçŸ¥å€¼ç­å·¥ç¨‹å¸ˆ
3. è¯Šæ–­é—®é¢˜åŸå› 
4. å®æ–½ä¿®å¤æªæ–½
5. ç›‘æ§ä¿®å¤æ•ˆæœ
6. æ›´æ–°æ–‡æ¡£
```

### 3. P2çº§åˆ«å‘Šè­¦ (ä¸­)

**è§¦å‘æ¡ä»¶**:
- éƒ¨åˆ†åŠŸèƒ½å—å½±å“
- æ€§èƒ½è½»å¾®ä¸‹é™
- éå…³é”®ç»„ä»¶æ•…éšœ

**å“åº”æµç¨‹**:
```
1. 1å°æ—¶å†…å“åº”
2. é€šçŸ¥è¿ç»´å›¢é˜Ÿ
3. è®¡åˆ’ä¿®å¤æ—¶é—´
4. å®æ–½ä¿®å¤
5. éªŒè¯ä¿®å¤æ•ˆæœ
```

### 4. P3çº§åˆ«å‘Šè­¦ (ä½)

**è§¦å‘æ¡ä»¶**:
- æ€§èƒ½ç›‘æ§å‘Šè­¦
- å®¹é‡è§„åˆ’æé†’
- ç»´æŠ¤æé†’

**å“åº”æµç¨‹**:
```
1. 4å°æ—¶å†…å“åº”
2. è®°å½•é—®é¢˜
3. è®¡åˆ’ç»´æŠ¤çª—å£
4. å®æ–½æ”¹è¿›
```

## ğŸ“ˆ ç›‘æ§æœ€ä½³å®è·µ

### 1. æŒ‡æ ‡æ”¶é›†

```bash
# å®šæœŸæ£€æŸ¥æŒ‡æ ‡æ”¶é›†çŠ¶æ€
curl -s http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | select(.health != "up")'

# éªŒè¯æŒ‡æ ‡æ•°æ®å®Œæ•´æ€§
curl -s http://localhost:9090/api/v1/query?query=up | jq '.data.result[] | select(.value[1] != "1")'
```

### 2. å‘Šè­¦è§„åˆ™ä¼˜åŒ–

```yaml
# é¿å…å‘Šè­¦é£æš´
groups:
  - name: qte_alerts
    rules:
      - alert: HighErrorRate
        expr: rate(qte_errors_total[5m]) > 0.1
        for: 2m  # æŒç»­2åˆ†é’Ÿæ‰å‘Šè­¦
        labels:
          severity: warning
```

### 3. ä»ªè¡¨æ¿è®¾è®¡

```
å…³é”®åŸåˆ™:
1. åˆ†å±‚å±•ç¤º - æ€»è§ˆ -> è¯¦ç»†
2. å®æ—¶æ›´æ–° - 5-30ç§’åˆ·æ–°
3. é¢œè‰²ç¼–ç  - ç»¿è‰²æ­£å¸¸ï¼Œé»„è‰²è­¦å‘Šï¼Œçº¢è‰²é”™è¯¯
4. è¶‹åŠ¿åˆ†æ - æ˜¾ç¤ºå†å²è¶‹åŠ¿
5. é’»å–èƒ½åŠ› - æ”¯æŒæ·±å…¥åˆ†æ
```

### 4. å®¹é‡è§„åˆ’

```bash
# ç›‘æ§èµ„æºä½¿ç”¨è¶‹åŠ¿
# CPUä½¿ç”¨ç‡è¶‹åŠ¿
curl -s "http://localhost:9090/api/v1/query_range?query=100-avg(irate(node_cpu_seconds_total{mode='idle'}[5m]))*100&start=$(date -d '7 days ago' +%s)&end=$(date +%s)&step=3600"

# å†…å­˜ä½¿ç”¨è¶‹åŠ¿
curl -s "http://localhost:9090/api/v1/query_range?query=(1-node_memory_MemAvailable_bytes/node_memory_MemTotal_bytes)*100&start=$(date -d '7 days ago' +%s)&end=$(date +%s)&step=3600"
```

## ğŸ”§ ç›‘æ§å·¥å…·ä½¿ç”¨

### 1. Grafanaä»ªè¡¨æ¿

**è®¿é—®åœ°å€**: https://grafana.qte.local:3000

**ä¸»è¦ä»ªè¡¨æ¿**:
- QTEæ€»è§ˆä»ªè¡¨æ¿
- ä¸šåŠ¡æŒ‡æ ‡ä»ªè¡¨æ¿
- ç³»ç»Ÿæ€§èƒ½ä»ªè¡¨æ¿
- å®‰å…¨ç›‘æ§ä»ªè¡¨æ¿

### 2. PrometheusæŸ¥è¯¢

```promql
# å¸¸ç”¨æŸ¥è¯¢ç¤ºä¾‹

# äº‹ä»¶å¤„ç†é€Ÿç‡
rate(qte_events_processed_total[5m])

# APIå“åº”æ—¶é—´95åˆ†ä½æ•°
histogram_quantile(0.95, rate(qte_request_duration_seconds_bucket[5m]))

# é”™è¯¯ç‡
rate(qte_errors_total[5m]) / rate(qte_requests_total[5m])

# å†…å­˜ä½¿ç”¨ç‡
(qte_memory_usage_bytes / qte_memory_limit_bytes) * 100
```

### 3. å‘Šè­¦ç®¡ç†

```bash
# æŸ¥çœ‹æ´»è·ƒå‘Šè­¦
curl -s http://localhost:9093/api/v1/alerts | jq '.data[] | select(.status.state == "firing")'

# é™é»˜å‘Šè­¦
curl -X POST http://localhost:9093/api/v1/silences \
  -H "Content-Type: application/json" \
  -d '{"matchers":[{"name":"alertname","value":"HighCPUUsage"}],"startsAt":"2023-12-18T10:00:00Z","endsAt":"2023-12-18T12:00:00Z","comment":"ç»´æŠ¤çª—å£"}'
```

## ğŸ“ æ”¯æŒå’ŒåŸ¹è®­

### è”ç³»æ–¹å¼
- **ç›‘æ§æ”¯æŒ**: monitoring@company.com
- **åŸ¹è®­é¢„çº¦**: training@company.com
- **æ–‡æ¡£åé¦ˆ**: docs@company.com

### åŸ¹è®­èµ„æº
- Grafanaä½¿ç”¨åŸ¹è®­
- PrometheusæŸ¥è¯¢è¯­è¨€åŸ¹è®­
- å‘Šè­¦å“åº”æµç¨‹åŸ¹è®­
- æ•…éšœæ’é™¤æŠ€èƒ½åŸ¹è®­

---

**æ³¨æ„**: æœ¬æŒ‡å—åº”ä¸ç³»ç»Ÿæ›´æ–°åŒæ­¥ç»´æŠ¤ï¼Œç¡®ä¿æŒ‡æ ‡å®šä¹‰å’Œé˜ˆå€¼çš„å‡†ç¡®æ€§ã€‚
